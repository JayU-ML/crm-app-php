<?= include("assets/php/top.php"); ?>

  <div class="clearfix"></div>

  <div class="content-wrapper">
  <div class="container-fluid">
    
    <div id="container"  class="col-lg-12" style="height: 50rem;"></div>

    <br>

    <div class="col-lg-12">
        <div class="card">
        <div class="card-body">
            <h5 class="card-title">　　運行履歴</h5>
            <div class="table-responsive table-striped table-hover">

            <table class="table" id="htmlTable">
                <!-- 表項目 -->
                <!-- <thead> -->
                <tr>
                    <th scope="col">依頼</th>                  
                    <th scope="col">積日</th>
                    <th scope="col">積手</th>
                    <th scope="col">積地</th>
                    <th scope="col">卸日</th>
                    <th scope="col">卸手</th>
                    <th scope="col">卸地</th>
                    <th scope="col">運賃</th>
                    <th scope="col">距離</th>
                </tr>
                <?php
                
                $fp = fopen('./assets/data/shipping_data.csv','r');


                while (!feof($fp)){
                    $row = rtrim(fgets($fp),"\n");
                    if($row !== ''){
                    $txt = explode(',',$row);

                    echo '<tr>';
                    for($i = 0; $i < count($txt); ++$i){
                        echo '<td>'.$txt[$i].'</td>';
                    }
                    echo '</tr>';
                    }
                }

                fclose($fp);

                ?>
                <!-- </tbody> -->

            </table>
            </div>
        </div>
        </div>

  </div>
  </div>

  <script src="https://cdn.anychart.com/releases/v8/js/anychart-base.min.js"></script>
  <script src="https://cdn.anychart.com/releases/v8/js/anychart-ui.min.js"></script>
  <script src="https://cdn.anychart.com/releases/v8/js/anychart-exports.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/regression/1.4.0/regression.min.js"></script>
  
  <script type="text/javascript">
    let rawData = [
[63000,107.9],
[48000,39],
[37000,92.6],
[43000,105.1],
[23000,60.3],
[27000,26.6],
[40000,101],
[14000,16.3],
[60000,227.7],
[60000,100.3],
[60000,105.3],
[55000,95.4],
[50000,169.9],
[31000,100.6],
[38000,68],
[18000,29.9],
[15000,20.1],
[33000,123],
[34000,57.3],
[30000,120.2],
[30000,113],
[70000,117.1],
[60000,129.6],
[100000,93.6],
[90000,127.1],
[60000,96.7],
[27000,58.8],
[26000,86.8],
[45000,105.7],
[20000,118.4],
[56000,98.3],
[38000,68],
[18000,29.9],
[15000,20.1],
[38000,183.5],
[38000,59.8],
[22000,16.3],
[14000,16.3],
[100000,118.1],
[70000,408.1],
[50000,215.6],
[31000,100.6],
[38000,68],
[18000,29.9],
[15000,20.1],
[45000,120.1],
[45000,114.9],
[30000,383.3],
[90000,73.5],
[25000,117.3],
[35000,90.7],
[18000,29.9],
[15000,20.1],
[32000,269.1],
[30000,102.4],
[60000,78.5],
[18000,29.9],
[15000,20.1],
[50000,187],
[24000,15.8],
[23000,60.3],
[27000,65.4],
[50000,108.1],
[42000,83.2],
[90000,99.6],
[50000,123.8],
[31000,100.6],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[37000,114.2],
[34000,14.5],
[38000,127.7],
[48000,123.2],
[30000,88.9],
[90000,26.1],
[80000,113.1],
[70000,90.6],
[90000,122.4],
[80000,215.9],
[15000,7.2],
[38000,125],
[18000,29.9],
[15000,20.1],
[50000,91.5],
[35000,72.3],
[38000,126.5],
[50000,70.7],
[38000,119.3],
[34000,136.6],
[14000,16.3],
[60000,54],
[80000,34.6],
[60000,74.9],
[60000,218.1],
[31000,100.6],
[30000,11.9],
[18000,29.9],
[15000,20.1],
[32000,130.5],
[35000,121.4],
[47000,285.9],
[100000,375.9],
[80000,43],
[45000,121.6],
[50000,94],
[45000,99.6],
[18000,29.9],
[15000,20.1],
[70000,21.1],
[65000,115.9],
[34000,62.5],
[68000,114],
[85000,112.4],
[200000,241.7],
[100000,97.9],
[30000,240.7],
[80000,123.5],
[22000,130.3],
[31000,100.6],
[38000,87.2],
[18000,29.9],
[15000,20.1],
[34000,48],
[26000,231.7],
[70000,139.9],
[34000,110.5],
[8500,11.4],
[58000,102.6],
[70000,149.1],
[65000,98.4],
[31000,39],
[38000,77.1],
[31000,100.6],
[38000,125],
[18000,29.9],
[15000,20.1],
[34000,121.4],
[36000,163.9],
[80000,112.6],
[70000,95.8],
[80000,54.1],
[18000,29.9],
[15000,20.1],
[25000,50.3],
[65000,472.4],
[90000,127.7],
[18000,29.9],
[15000,20.1],
[20000,129.1],
[50000,64.9],
[40000,131.3],
[42500,107.9],
[45000,126.7],
[100000,122.9],
[30000,110.5],
[80000,127.5],
[31000,100.6],
[38000,125],
[18000,29.9],
[15000,20.1],
[25000,18.9],
[80000,244],
[50000,72.6],
[90000,109],
[90000,119.8],
[38000,102.1],
[18000,29.9],
[30000,20.1],
[60000,114.8],
[20000,28.6],
[30000,110.2],
[15000,9.6],
[130000,383.8],
[60000,284.7],
[80000,91.2],
[80000,128.8],
[80000,99.9],
[90000,288.2],
[31000,100.6],
[30000,15.6],
[18000,29.9],
[15000,20.1],
[80000,179.5],
[50000,129.2],
[25000,10.3],
[54000,109.6],
[65000,127.9],
[69000,127.9],
[70000,469.1],
[42000,83.2],
[100000,118.4],
[60000,90],
[140000,121.5],
[110000,128.7],
[170000,229.2],
[60000,92.8],
[90000,93.6],
[100000,448.3],
[70000,104.2],
[38000,73],
[18000,29.9],
[15000,20.1],
[58000,116.2],
[65000,115.9],
[65000,129.1],
[30000,10.3],
[120000,327.1],
[60000,101.3],
[70000,88.3],
[100000,110.6],
[100000,106.9],
[70000,128],
[90000,216.5],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[46000,83.9],
[170000,420.8],
[65000,97.2],
[65000,123.8],
[65000,94.8],
[130000,106.8],
[50000,262.9],
[70000,116.7],
[100000,123.7],
[100000,408.3],
[80000,117.2],
[100000,115.8],
[31000,100.6],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[65000,470.3],
[130000,425.8],
[85000,124.3],
[40000,121.4],
[85000,123.5],
[85000,124],
[50000,420.9],
[18000,29.9],
[15000,20.1],
[74000,151.1],
[35000,9.6],
[70000,102.4],
[70000,119.9],
[70000,121.5],
[110000,243.4],
[27000,21.1],
[38000,94.9],
[18000,29.9],
[15000,20.1],
[65000,123.6],
[26000,231.7],
[20000,28.6],
[45000,103.4],
[22000,149.1],
[22000,16.3],
[90000,123.1],
[80000,76.1],
[15000,10.1],
[26000,5.9],
[42000,77.1],
[35000,121.1],
[30000,121.9],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[32000,110.5],
[55000,135.1],
[60000,164.6],
[69000,98.7],
[41000,74.6],
[44000,76.2],
[50000,77.9],
[80000,107.7],
[180000,306.4],
[100000,126],
[25000,112.7],
[56000,108.3],
[31000,100.6],
[65000,138.6],
[18000,29.9],
[15000,20.1],
[50000,97.6],
[65000,98.7],
[130000,100.3],
[26000,118.4],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[26000,231.7],
[30000,121.4],
[38000,121.2],
[25000,121.4],
[65000,54],
[28000,103.4],
[45000,172.2],
[14000,16.3],
[70000,149.1],
[45000,121.4],
[31000,100.6],
[38000,125],
[18000,29.9],
[15000,20.1],
[41000,39],
[20000,10.1],
[39000,231.7],
[55000,121.4],
[28000,39],
[10100,26.7],
[70000,97.8],
[70000,126],
[40000,97],
[50000,139.2],
[30000,175.5],
[43000,110.5],
[70000,251.8],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[23000,66.9],
[35000,121.4],
[42000,149.1],
[63000,39],
[63000,39],
[26000,231.7],
[52000,189.5],
[64000,99.3],
[19200,11.5],
[32000,48.6],
[40000,113.8],
[28000,103.4],
[14000,16.3],
[22000,16.3],
[60000,73.2],
[90000,73.2],
[50000,121.4],
[31000,100.6],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[38000,182.8],
[50000,118.8],
[50000,126.9],
[50000,95.5],
[30000,92.1],
[47000,66.9],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[59000,13],
[40000,128.1],
[33000,29.9],
[15000,20.1],
[55000,103.4],
[28000,116.6],
[35000,178.1],
[60000,98.4],
[40000,98],
[40000,183.3],
[50000,60.3],
[50000,120.9],
[28000,24.7],
[26000,49.6],
[56000,98.3],
[31000,100.6],
[30000,92.7],
[45000,177.5],
[38000,94.9],
[18000,29.9],
[15000,20.1],
[35000,35.7],
[30000,103.4],
[58000,237.8],
[35000,83.2],
[14000,16.3],
[22000,16.3],
[130000,93.4],
[28000,107.2],
[26000,13.2],
[30000,103.4],
[38000,94.9],
[18000,29.9],
[15000,20.1],
[38000,183],
[31000,100.6],
[100000,127.7],
[20000,41],
[70000,275.9],
[60000,299.2],
[80000,94.4],
[80000,184.3],
[18000,29.9],
[15000,20.1],
[45000,138.2],
[70000,93.9],
[30000,98.8],
[40000,46.6],
[35000,93.7],
[18000,29.9],
[15000,20.1],
[100000,112.9],
[50000,143.1],
[65000,124.9],
[30000,36],
[80000,113.7],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[37000,115.4],
[25000,13.9],
[30000,33.7],
[50000,43],
[31000,100.6],
[100000,94.1],
[38000,94.9],
[18000,29.9],
[15000,20.1],
[31000,100.6],
[30000,88.9],
[140000,401.6],
[130000,273.7],
[26000,15.8],
[30000,134.3],
[38000,120.7],
[18000,29.9],
[15000,20.1],
[28000,18.3],
[45000,90],
[37000,115.4],
[65000,124.5],
[19000,15.8],
[25000,118.1],
[100000,128.1],
[50000,114.5],
[80000,123.2],
[35000,19.3],
[38000,94.9],
[18000,29.9],
[15000,20.1],
[29000,124.2],
[65000,114.6],
[44000,66.7],
[70400,292.7],
[20350,9.7],
[32000,353.5],
[23000,32.2],
[70000,118.7],
[40000,100.8],
[80000,125.5],
[70000,126.8],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[38000,183],
[35000,126.8],
[65000,121.7],
[69000,105.7],
[31000,100.6],
[110000,359.1],
[60000,360.2],
[50000,90.1],
[90000,66],
[70000,119.9],
[65000,119],
[38000,94.9],
[18000,29.9],
[15000,20.1],
[42000,88.5],
[69000,119.6],
[69000,127.6],
[30000,103.5],
[50000,96.2],
[18000,29.9],
[15000,20.1],
[57000,101.3],
[28000,129.1],
[38000,126],
[60000,93.9],
[130000,441.2],
[30000,97],
[53000,289.2],
[47000,114.5],
[63000,108.3],
[45000,99.6],
[18000,29.9],
[15000,20.1],
[40000,113.8],
[38000,182.4],
[37000,115.4],
[42000,92.2],
[31000,100.6],
[45000,78.3],
[70000,121.6],
[90000,111.9],
[100000,104.3],
[120000,113.2],
[130000,121.6],
[18000,29.9],
[15000,20.1],
[31000,100.6],
[30000,19.4],
[70000,121.7],
[70000,124],
[50000,94.4],
[60000,127.3],
[65000,117.7],
[30000,25.9],
[18000,29.9],
[15000,20.1],
[30000,19.3],
[39000,108.8],
[38000,119.3],
[60000,72.2],
[38000,96.8],
[18000,29.9],
[15000,20.1],
[37000,115.4],
[65000,121.3],
[30000,33.7],
[31000,100.6],
[35000,40],
[55000,99.6],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[38000,183],
[36000,61.9],
[69000,109.1],
[30000,33.7],
[21000,32.9],
[41000,126],
[90000,107.7],
[80000,90.1],
[63000,104.4],
[63000,250.4],
[38000,102.1],
[15000,20.1],
[31000,100.6],
[22000,32.9],
[60000,331],
[40000,107.7],
[100000,87.3],
[50000,422.1],
[60000,107.7],
[45000,465.7],
[45000,102.2],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[20000,104.6],
[50000,2.6],
[18000,29.9],
[15000,20.1],
[25000,21.8],
[30000,33.7],
[31000,100.6],
[28000,129.1],
[18070,58.9],
[50000,111.2],
[40000,10],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[58000,175.6],
[65000,121.3],
[30000,33.7],
[18000,9],
[42000,128.9],
[41000,113.3],
[45000,104.8],
[80000,111.5],
[70000,124],
[38000,16.5],
[18000,29.9],
[15000,20.1],
[52000,128.7],
[60000,139.9],
[30000,33.7],
[62400,107.7],
[60000,75.7],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[28000,28.5],
[31000,100.6],
[28000,100.6],
[25000,27.1],
[100000,91.7],
[50000,96.8],
[60000,125.5],
[18000,29.9],
[15000,20.1],
[25000,21.8],
[42000,80.6],
[70000,474.9],
[32000,353.5],
[34000,136.6],
[130000,127.9],
[80000,219.4],
[130000,99.6],
[100000,212.1],
[40000,96.9],
[50000,119.2],
[40000,124],
[30000,44.9],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[50000,94.6],
[25000,19.2],
[100000,124],
[60000,112.6],
[38000,96.8],
[18000,29.9],
[15000,20.1],
[31000,100.6],
[80000,132.2],
[80000,104.6],
[85000,298.9],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[110000,13.6],
[60000,465.2],
[60000,121.6],
[18000,29.9],
[15000,20.1],
[31000,100.6],
[28000,70.9],
[30000,120.3],
[60000,75.3],
[90000,113],
[130000,97.3],
[50000,119.9],
[35000,98],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[37000,115.4],
[44000,138.8],
[65000,122.6],
[24000,15.8],
[50000,122],
[100000,111.3],
[140000,93.3],
[30000,48.4],
[38000,102.1],
[18000,29.9],
[15000,20.1],
[69000,131.4],
[58000,82.8],
[22000,15.8],
[40000,223.3],
[70000,87.3],
[45000,121.6],
[38000,68],
[18000,29.9],
[15000,20.1],
[32000,124.2],
[37000,115.4],
[34000,74.3],
[31000,100.6],
[24000,19.3],
[45000,118.5],
[120000,138],
[40000,95.7],
[35000,108.8],
[35000,127.4],
[30000,330],
[38000,94.9],
[18000,29.9],
[15000,20.1],
[45000,106.9],
[42000,83.2],
[38000,118.8],
[24200,33.9],
[40000,120],
[70000,128.1],
[80000,123.7],
[80000,331.8],
[70000,56.9],
[90000,100.4],
[60000,90.1],
[27000,16.3],
[30000,18.4],
[38000,94.9],
[18000,29.9],
[15000,20.1],
[32000,124.2],
[30000,33.7],
[24000,33.9],
[30000,61.5],
[40000,71.4],
[48000,77.7],
[45000,113.8],
[34000,121.9],
[35000,98],
[25000,291.9],
[40000,97.9],
[15000,20.1],
[18000,29.9],
[60000,139.9],
[38000,15.5],
[30000,33.7],
[35000,52.2],
[31000,100.6],
[19000,15.8],
[45000,114.4],
[35000,155.8],
[24000,154],
[35000,116.5],
[71000,119],
[30000,279.3],
[15000,20.1],
[18000,29.9],
[15000,7.9],
[30000,33.7],
[40000,92.1],
[47000,69.1],
[28000,77.4],
[38000,68],
[15000,20.1],
[18000,29.9],
[43000,96.5],
[32000,312.1],
[48000,48.7],
[30000,33.7],
[36000,13.2],
[31000,100.6],
[30000,134.5],
[43000,111.8],
[51000,200.4],
[55000,88.4],
[47000,119.8],
[15000,20.1],
[18000,29.9],
[30000,33.7],
[28000,116.9],
[40000,117.7],
[31000,100.6],
[50000,127],
[28000,115.4],
[16000,19.6],
[38000,150.3],
[30000,67.3],
[15000,20.1],
[18000,29.9],
[31000,100.6],
[15000,20.1],
[18000,29.9],
[15000,20.1],
[18000,29.9],
[30000,33.7],
[35000,132.8],
[30000,15.5],
[40000,120.9],
[38000,68],
[15000,20.1],
[18000,29.9],
[38000,181.2],
[30000,33.7],
[38000,150.3],
[31000,100.6],
[21000,32.9],
[47000,91.3],
[28000,18.4],
[42000,112.8],
[45000,99.6],
[15000,20.1],
[18000,29.9],
[52000,140.9],
[41000,92.9],
[70000,86.7],
[30000,33.7],
[31000,100.6],
[30000,19.4],
[31000,16.3],
[38000,119.3],
[55000,144],
[30000,125.8],
[35000,111.6],
[15000,20.1],
[18000,29.9],
[40000,217.1],
[31000,100.6],
[15000,20.1],
[18000,29.9],
[19500,51.3],
[30000,33.7],
[16000,5.7],
[37000,238],
[29000,120.7],
[73000,127.6],
[30000,110.9],
[40000,106.5],
[35000,230.7],
[38000,96.7],
[15000,20.1],
[18000,29.9],
[30000,33.7],
[28000,48.9],
[33600,48.9],
[32000,353.5],
[15000,20.1],
[18000,29.9],
[27000,106.5],
[38000,182.4],
[31000,100.6],
[19000,19.3],
[30000,44.9],
[15000,20.1],
[18000,29.9],
[15000,20.1],
[18000,29.9],
[30000,33.7],
[30000,47.3],
[31000,100.6],
[40000,125.1],
[30000,95.8],
[36000,115.1],
[30000,54],
[15000,20.1],
[18000,29.9],
[70000,86.7],
[30000,33.7],
[19000,19.4],
[38000,125],
[15000,20.1],
[18000,29.9],
[36000,88.2],
[38000,183],
[30000,33.7],
[31000,100.6],
[60000,125.2],
[60000,125.2],
[43000,112.3],
[38000,119.3],
[22000,117.3],
[30000,66.6],
[15000,20.1],
[18000,29.9],
[23000,57.3],
[38000,151.7],
[30000,33.7],
[25000,11.9],
[50000,128.7],
[60000,105.1],
[48000,91],
[15000,20.1],
[18000,29.9],
[30000,79.2],
[38000,115.4],
[30000,33.7],
[19000,19.3],
[23000,32.2],
[80000,142.4],
[60000,108.2],
[23000,142.3],
[15000,20.1],
[18000,29.9],
[32000,303.6],
[31000,100.6],
[100000,124.3],
[48000,91],
[15000,20.1],
[18000,29.9],
[15000,20.1],
[18000,29.9],
[100000,123.9],
[60000,123.9],
[15000,20.1],
[18000,29.9],
[30000,33.7],
[23000,32.2],
[15000,20.1],
[18000,29.9],
[60000,110.9],
[15000,20.1],
[18000,29.9],
[31000,100.6],
[80000,90.6],
[15000,20.1],
[18000,29.9],
[40000,103.5],
// [,59.8],
[15000,20.1],
[18000,29.9],
[45000,108.3],
[93600,111.9],
[18000,13.2],
[31000,100.6],
[30000,19.4],
[30000,88.9],
[25000,119.2],
[40000,122.6],
[38000,68],
[15000,20.1],
[18000,29.9],
[19000,15.8],
[32000,353.5],
[48000,112.4],
[28000,109.2],
[38000,68],
[15000,20.1],
[18000,29.9],
[31000,100.6],
[19000,15.8],
[15000,20.1],
[15000,20.1],
[18000,29.9],
[25000,61.5],
[25000,24.9],
[15000,20.1],
[18000,29.9]
    ];

    let result = regression('linear', rawData);

    let coeff = result.equation;

    anychart.onDocumentReady(function () {

      let data_1 = rawData;
      let data_2 = setTheoryData(rawData);

      chart = anychart.scatter();

      chart.title("計算式: " + result.string + "\n相関係数 (ってか平均値): " + result.r2.toPrecision(2));

      chart.legend(true);

      let series1 = chart.marker(data_1);
      series1.name("運行実績");

  
      let series2 = chart.line(data_2);
      series2.name("平均");
      series2.markers(true);

      // id="container"にdrow!
      chart.container("container");
      chart.draw();
    });

    function formula(coeff, x) {
      let result = null;
      for (let i = 0, j = coeff.length - 1; i < coeff.length; i++, j--) {
        result += coeff[i] * Math.pow(x, j);
      }
      return result;
    }
    
    function setTheoryData(rawData) {
      let theoryData = [];
      for (let i = 0; i < rawData.length; i++) {
        theoryData[i] = [rawData[i][0], formula(coeff, rawData[i][0])];
      }
      return theoryData;
    }
</script>

</body>
</html>